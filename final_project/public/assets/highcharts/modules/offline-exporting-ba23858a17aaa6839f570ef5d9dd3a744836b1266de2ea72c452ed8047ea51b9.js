!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){function e(t,e){var n=r.getElementsByTagName("head")[0],o=r.createElement("script");o.type="text/javascript",o.src=t,o.onload=e,n.appendChild(o)}var n=t.win,o=n.navigator,r=n.document;t.CanVGRenderer={},t.Chart.prototype.exportChartLocal=function(a,i){var c,l,s,h,g,d=this,p=t.merge(d.options.exporting,a),m=o.userAgent.indexOf("WebKit")>-1&&o.userAgent.indexOf("Chrome")<0,f=p.scale||2,u=n.URL||n.webkitURL||n,v=0,w=function(){if(p.fallbackToExportServer===!1){if(!p.error)throw"Fallback to export server disabled";p.error()}else d.exportChart(p)},x=function(t,e,o,a,i,c,l,s){var h,g=new n.Image,d=function(){var n,i=r.createElement("canvas"),l=i.getContext&&i.getContext("2d");try{if(l){i.height=g.height*f,i.width=g.width*f,l.drawImage(g,0,0,i.width,i.height);try{n=i.toDataURL(e),a(n,e,o)}catch(d){if("SecurityError"!==d.name&&"SECURITY_ERR"!==d.name&&"SecurityError"!==d.message)throw d;h(t,e,o)}}else c(t,e,o)}finally{s&&s(t,e,o)}},p=function(){l(t,e,o),s&&s(t,e,o)};h=function(){g=new n.Image,h=i,g.crossOrigin="Anonymous",g.onload=d,g.onerror=p,g.src=t},g.onload=d,g.onerror=p,g.src=t},y=function(t){try{if(!m&&o.userAgent.toLowerCase().indexOf("firefox")<0)return u.createObjectURL(new n.Blob([t],{type:"image/svg+xml;charset-utf-16"}))}catch(e){}return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(t)},b=function(t,e){var a,i=r.createElement("a"),c=(p.filename||"chart")+"."+e;if(o.msSaveOrOpenBlob)return void o.msSaveOrOpenBlob(t,c);if(void 0!==i.download)i.href=t,i.download=c,i.target="_blank",r.body.appendChild(i),i.click(),r.body.removeChild(i);else try{if(a=n.open(t,"chart"),void 0===a||null===a)throw"Failed to open window"}catch(l){n.location.href=t}},C=function(){var a,i,l=p&&p.type||"image/png",s=l.split("/")[1],h=d.sanitizeSVG(c.innerHTML);if("image/svg+xml"===l)try{o.msSaveOrOpenBlob?(i=new MSBlobBuilder,i.append(h),a=i.getBlob("image/svg+xml")):a=y(h),b(a,"svg")}catch(g){w()}else a=y(h),x(a,l,{},function(t){try{b(t,s)}catch(e){w()}},function(){var a=r.createElement("canvas"),i=a.getContext("2d"),c=h.match(/^<svg[^>]*width\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*f,g=h.match(/^<svg[^>]*height\s*=\s*\"?(\d+)\"?[^>]*>/)[1]*f,p=function(){i.drawSvg(h,0,0,c,g);try{b(o.msSaveOrOpenBlob?a.msToBlob():a.toDataURL(l),s)}catch(t){w()}};a.width=c,a.height=g,n.canvg?p():(d.showLoading(),e(t.getOptions().global.canvasToolsURL,function(){d.hideLoading(),p()}))},w,w,function(){try{u.revokeObjectURL(a)}catch(t){}})},L=function(t,e,n){++v,n.imageElement.setAttributeNS("http://www.w3.org/1999/xlink","href",t),v===l.length&&C()};t.wrap(t.Chart.prototype,"getChartHTML",function(t){return c=this.container.cloneNode(!0),t.apply(this,Array.prototype.slice.call(arguments,1))}),d.getSVGForExport(p,i),l=c.getElementsByTagName("image");try{for(l.length||C(),h=0,g=l.length;g>h;++h)s=l[h],x(s.getAttributeNS("http://www.w3.org/1999/xlink","href"),"image/png",{imageElement:s},L,w,w,w)}catch(O){w()}},t.getOptions().exporting.buttons.contextButton.menuItems=[{textKey:"printChart",onclick:function(){this.print()}},{separator:!0},{textKey:"downloadPNG",onclick:function(){this.exportChartLocal()}},{textKey:"downloadJPEG",onclick:function(){this.exportChartLocal({type:"image/jpeg"})}},{textKey:"downloadSVG",onclick:function(){this.exportChartLocal({type:"image/svg+xml"})}}]});